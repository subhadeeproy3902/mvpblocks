{
  "name": "variable-proximity-text",
  "description": "Interactive text where font weight changes based on mouse proximity to each letter.",
  "type": "registry:ui",
  "dependencies": [
    "framer-motion",
    "react"
  ],
  "registryDependencies": [],
  "files": [
    {
      "type": "registry:ui",
      "content": "'use client';\n\nimport { useRef, useEffect, useCallback, RefObject } from 'react';\n\ninterface VariableProximityTextProps {\n  label: string;\n  fromFontVariationSettings?: string;\n  toFontVariationSettings?: string;\n  containerRef: RefObject<HTMLElement | null>;\n  radius?: number;\n  falloff?: 'linear' | 'exponential' | 'gaussian';\n  className?: string;\n  style?: React.CSSProperties;\n}\n\nexport function VariableProximityText({\n  label,\n  fromFontVariationSettings = \"'wght' 400, 'opsz' 9\",\n  toFontVariationSettings = \"'wght' 900, 'opsz' 40\",\n  containerRef,\n  radius = 100,\n  falloff = 'linear',\n  className = '',\n  style,\n}: VariableProximityTextProps) {\n  const spanRef = useRef<HTMLSpanElement>(null);\n  const letterRefs = useRef<(HTMLSpanElement | null)[]>([]);\n  const mousePos = useRef({ x: -1000, y: -1000 });\n  const rafId = useRef<number>(0);\n\n  // Parse font variation settings\n  const parseSettings = useCallback((settingsStr: string) => {\n    const map = new Map<string, number>();\n    settingsStr.split(',').forEach((s) => {\n      const trimmed = s.trim();\n      const match = trimmed.match(/['\"]?(\\w+)['\"]?\\s+([\\d.]+)/);\n      if (match) {\n        map.set(match[1], parseFloat(match[2]));\n      }\n    });\n    return map;\n  }, []);\n\n  const fromSettings = parseSettings(fromFontVariationSettings);\n  const toSettings = parseSettings(toFontVariationSettings);\n\n  const calculateFalloff = useCallback(\n    (distance: number) => {\n      const norm = Math.min(Math.max(1 - distance / radius, 0), 1);\n      switch (falloff) {\n        case 'exponential':\n          return norm ** 2;\n        case 'gaussian':\n          return Math.exp(-((distance / (radius / 2)) ** 2) / 2);\n        case 'linear':\n        default:\n          return norm;\n      }\n    },\n    [radius, falloff],\n  );\n\n  const updateLetters = useCallback(() => {\n    if (!containerRef.current) return;\n\n    const containerRect = containerRef.current.getBoundingClientRect();\n\n    letterRefs.current.forEach((letterEl) => {\n      if (!letterEl) return;\n\n      const rect = letterEl.getBoundingClientRect();\n      const letterCenterX = rect.left + rect.width / 2 - containerRect.left;\n      const letterCenterY = rect.top + rect.height / 2 - containerRect.top;\n\n      const dx = mousePos.current.x - letterCenterX;\n      const dy = mousePos.current.y - letterCenterY;\n      const distance = Math.sqrt(dx * dx + dy * dy);\n\n      if (distance >= radius) {\n        letterEl.style.fontVariationSettings = fromFontVariationSettings;\n      } else {\n        const falloffValue = calculateFalloff(distance);\n        const newSettings: string[] = [];\n\n        fromSettings.forEach((fromValue, axis) => {\n          const toValue = toSettings.get(axis) ?? fromValue;\n          const interpolated = fromValue + (toValue - fromValue) * falloffValue;\n          newSettings.push(`'${axis}' ${interpolated}`);\n        });\n\n        letterEl.style.fontVariationSettings = newSettings.join(', ');\n      }\n    });\n\n    rafId.current = requestAnimationFrame(updateLetters);\n  }, [\n    containerRef,\n    radius,\n    fromFontVariationSettings,\n    fromSettings,\n    toSettings,\n    calculateFalloff,\n  ]);\n\n  useEffect(() => {\n    const handleMouseMove = (e: MouseEvent) => {\n      if (!containerRef.current) return;\n      const rect = containerRef.current.getBoundingClientRect();\n      mousePos.current = {\n        x: e.clientX - rect.left,\n        y: e.clientY - rect.top,\n      };\n    };\n\n    const handleTouchMove = (e: TouchEvent) => {\n      if (!containerRef.current) return;\n      const rect = containerRef.current.getBoundingClientRect();\n      const touch = e.touches[0];\n      mousePos.current = {\n        x: touch.clientX - rect.left,\n        y: touch.clientY - rect.top,\n      };\n    };\n\n    const handleMouseLeave = () => {\n      mousePos.current = { x: -1000, y: -1000 };\n    };\n\n    window.addEventListener('mousemove', handleMouseMove);\n    window.addEventListener('touchmove', handleTouchMove);\n    containerRef.current?.addEventListener('mouseleave', handleMouseLeave);\n\n    // Start animation loop\n    rafId.current = requestAnimationFrame(updateLetters);\n\n    return () => {\n      window.removeEventListener('mousemove', handleMouseMove);\n      window.removeEventListener('touchmove', handleTouchMove);\n      containerRef.current?.removeEventListener('mouseleave', handleMouseLeave);\n      cancelAnimationFrame(rafId.current);\n    };\n  }, [containerRef, updateLetters]);\n\n  // Split into words and letters\n  const words = label.split(' ');\n  let globalIndex = 0;\n\n  return (\n    <span\n      ref={spanRef}\n      className={className}\n      style={{\n        display: 'inline',\n        fontFamily: \"'Roboto Flex', sans-serif\",\n        ...style,\n      }}\n    >\n      {words.map((word, wordIdx) => (\n        <span\n          key={wordIdx}\n          style={{ display: 'inline-block', whiteSpace: 'nowrap' }}\n        >\n          {word.split('').map((letter) => {\n            const idx = globalIndex++;\n            return (\n              <span\n                key={idx}\n                ref={(el) => {\n                  letterRefs.current[idx] = el;\n                }}\n                style={{\n                  display: 'inline-block',\n                  fontVariationSettings: fromFontVariationSettings,\n                }}\n              >\n                {letter}\n              </span>\n            );\n          })}\n          {wordIdx < words.length - 1 && (\n            <span style={{ display: 'inline-block' }}>&nbsp;</span>\n          )}\n        </span>\n      ))}\n    </span>\n  );\n}\n\nexport default VariableProximityText;\n",
      "path": "/components/ui/variable-proximity-text.tsx",
      "target": "components/ui/variable-proximity-text.tsx"
    }
  ],
  "categories": [
    "text-animation"
  ]
}